alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"Downrage_HTTP_C2"; flow:established,to_server; content:"POST"; http_method; content:"="; content:"=|20|HTTP/1.1"; fast_pattern; distance:19; within:10; pcre:"/^\/(?:[a-zA-Z0-9]{2,6}\/){2,5}[a-zA-Z0-9]{1,7}\.[A-Za-z0-9\+\-\_\.]+\/\?[a-zA-Z0-9]{1,3}=[a-zA-Z0-9+\/]{19}=$/I"; sid:911001833;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"Coreshell_HTTP_CALLOUT"; flow:established,to_server; content:"POST"; http_method; content:"User-Agent: MSIE "; fast_pattern:only; pcre:"/User-Agent: MSIE [89]\.0\x0d\x0a/D"; pcre:"/^\/(?:check|update|store|info)\/$/I"; sid:911001834;)
alert tcp any any -> any [$HTTP_PORTS,44300] (msg:"X Tunnel_HTTP_CONNECT_HANDSHAKE"; flow:established,to_server; dsize:4; content:"|00 00 00|"; offset:1; depth:3; byte_test:1,<,96,0; content:!"HTTP"; sid:911001835;)
alert tcp any any -> any 443 (msg:"X Tunnel_UPSTREAM_CONNECTION_EVENT"; flow:established,to_server; stream_size:either,=,20; content:"|02 00 00 10|"; depth:4; sid:911001836;)
alert tcp any any -> any 80 (content:".php?"; pcre:"/\/(?:index|status|captha|json|css|ajax|js)\.php\?(?:id|item|mode|page|status|s|f|t|k|l|m|n|b|v|c|app|js|css| im|code|search)=[a-z0-9]{0,26}\&(?:id|item|mode|page|status|s|f|t|k|l|m|n|b|v|c|app|js|css|im|code|search)=[a-z0-9]{0,26} HTTP/"; msg:"Cache_DLL beacon GET 2 arg"; sid:911001837;)
alert tcp any any -> any 80 (content:".php?"; pcre:"/\/(?:index|status|captha|json|css|ajax|js)\.php\?(?:id|item|mode|page|status|s|f|t|k|l|m|n|b|v|c|app|js|css| im|code|search)=[a-z0-9]{0,26}\&(?:id|item|mode|page|status|s|f|t|k|l|m|n|b|v|c|app|js|css|im|code|search)=[a-z0-9]{0,26}\&(?:id|item|mode|page|status|s|f|t|k|l|m|n|b|v|c|app|js|css|im|code|search)=[a-z0-9]{0,26} HTTP/"; msg:"Cache_DLL beacon GET 3 arg"; sid:911001838;)
alert tcp any any -> any 80 (content:".php?"; pcre:"/\/(?:index|status|captha|json|css|ajax|js)\.php\?(?:id|item|mode|page|status|s|f|t|k|l|m|n|b|v|c|app|js|css| im|code|search)=[a-z0-9]{0,26}\&(?:id|item|mode|page|status|s|f|t|k|l|m|n|b|v|c|app|js|css|im|code|search)=[a-z0-9]{0,26}\&(?:id|item|mode|page|status|s|f|t|k|l|m|n|b|v|c|app|js|css|im|code|search)=[a-z0-9]{0,26}\&(?:id|item|mode|page|status|s|f|t|k|l|m|n|b|v|c|app|js|css|im|code|search)=[a-z0-9]{0,26} HTTP/"; msg:"Cache_DLL beacon GET 4 arg"; sid:911001839;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"MAL_REFERER"; flow:established,to_server; content:"GET"; http_method; content:"&bvm=bv.81"; fast_pattern; http_header; content:",d."; distance:6; within:3; http_header; content:"|0D 0A|"; distance:3;within:2; http_header; content:!"Cookie|3A 20|"; http_header; pcre:"/https:\/\/www\.google\.com\/url\?sa=t&rct=j&q=&esrc=s&source=web&cd=(?:[0-9]|10|11)&ved=0C[A-L]{2}QFjA[A-L]&url=[^&]{1,512}&ei=[A-Za-z0-9]{20,22}&usg=[A-Za-z0-9_]{34}&bvm=bv\.81[1-7]{6}\,d\.[A-Za-z0-9_]{3}\x0d\x0a/D";sid:911001840;)
alert tcp any any -> any any (msg: "evil_twitter_callback"; content:"GET /api/asyncTwitter.php HTTP/1.1"; sid:911001841;)
alert tcp any any -> any 80 (content:"=650&"; pcre:"/=11&[^&]{1,7}?=2[^&]{6,12}&[^&]{1,7}?=410&[^&]{1,7}?=650&[^&]{1,7}?=51 HTTP\/1\.1/"; msg:"CozyCar"; sid:911001842;)
alert tcp any any -> any 80 (content:".php? HTTP"; content:"=12&"; distance:0; pcre:"/=12&[^&=]{1,7}?=2[^&=]{12,16}?==[^&=]{18,26}?==/"; msg:"CozyCarv2"; sid:911001843;)
alert tcp any any -> any 25 (msg:"MiniDuke-string1_slide_1_1 - new"; content:"IUgyYll"; pcre:"/IUgyYll(\x0d\x0a)??t(\x0d\x0a)??L(\x0d\x0a)??l(\x0d\x0a)??N(\x0d\x0a)??3(\x0d\x0a)??Q/"; sid:911001844;)
alert tcp any any -> any 25 (msg:"MiniDuke-string1_slide_1_2 - new"; content:"ltLlN3Q"; pcre:"/I(\x0d\x0a)??U(\x0d\x0a)??g(\x0d\x0a)??y(\x0d\x0a)??Y(\x0d\x0a)??l(\x0d\x0a)??ltLlN3Q/"; sid:911001845;)
alert tcp any any -> any 25 (msg:"MiniDuke-string1_slide_2_1 - new"; content:"FIMmJZ"; pcre:"/FIMmJZ(\x0d\x0a)??b(\x0d\x0a)??S(\x0d\x0a)??5(\x0d\x0a)??T(\x0d\x0a)??d(\x0d\x0a)??0/"; sid:911001846;)
alert tcp any any -> any 25 (msg:"MiniDuke-string1_slide_2_2 - new"; content:"bS5Td0"; pcre:"/F(\x0d\x0a)??I(\x0d\x0a)??M(\x0d\x0a)??m(\x0d\x0a)??J(\x0d\x0a)??Z(\x0d\x0a)??bS5Td0/"; sid:911001847;)
alert tcp any any -> any 25 (msg:"MiniDuke-string1_slide_3_1 - new"; content:"hSDJiWW"; pcre:"/hSDJiWW(\x0d\x0a)??0(\x0d\x0a)??u(\x0d\x0a)??U(\x0d\x0a)??3(\x0d\x0a)??d(\x0d\x0a)??A/"; sid:911001848;)
alert tcp any any -> any 25 (msg:"MiniDuke-string1_slide_3_2 - new"; content:"W0uU3dA"; pcre:"/h(\x0d\x0a)??S(\x0d\x0a)??D(\x0d\x0a)??J(\x0d\x0a)??i(\x0d\x0a)??W(\x0d\x0a)??W0uU3dA/"; sid:911001849;)
alert tcp any any -> any 25 (msg:"MiniDuke-string2_slide_1_1 - new"; content:"QDM0Zlo"; pcre:"/QDM0Zlo(\x0d\x0a)??3(\x0d\x0a)??R(\x0d\x0a)??V(\x0d\x0a)??t(\x0d\x0a)??w(\x0d\x0a)??X/"; sid:911001850;)
alert tcp any any -> any 25 (msg:"MiniDuke-string2_slide_1_2 - new"; content:"o3RVtwX"; pcre:"/Q(\x0d\x0a)??D(\x0d\x0a)??M(\x0d\x0a)??0(\x0d\x0a)??Z(\x0d\x0a)??l(\x0d\x0a)??o3RVtwX/"; sid:911001851;)
alert tcp any any -> any 25 (msg:"MiniDuke-string2_slide_2_1 - new"; content:"AzNGZa"; pcre:"/AzNGZa(\x0d\x0a)??N(\x0d\x0a)??0(\x0d\x0a)??V(\x0d\x0a)??b(\x0d\x0a)??c(\x0d\x0a)??F/"; sid:911001852;)
alert tcp any any -> any 25 (msg:"MiniDuke-string2_slide_2_2 - new"; content:"N0VbcF"; pcre:"/A(\x0d\x0a)??z(\x0d\x0a)??N(\x0d\x0a)??G(\x0d\x0a)??Z(\x0d\x0a)??a(\x0d\x0a)??N0VbcF/"; sid:911001853;)
alert tcp any any -> any 25 (msg:"MiniDuke-string2_slide_3_1 - new"; content:"AMzRmWj"; pcre:"/AMzRmWj(\x0d\x0a)??d(\x0d\x0a)??F(\x0d\x0a)??W(\x0d\x0a)??3(\x0d\x0a)??B(\x0d\x0a)??c/"; sid:911001854;)
alert tcp any any -> any 25 (msg:"MiniDuke-string2_slide_3_2 - new"; content:"jdFW3Bc"; pcre:"/A(\x0d\x0a)??M(\x0d\x0a)??z(\x0d\x0a)??R(\x0d\x0a)??m(\x0d\x0a)??W(\x0d\x0a)??jdFW3Bc/"; sid:911001855;)
alert tcp any any -> any 80 (msg:"CosmicDuke HTTP Beacon"; content:"&BranchID="; pcre:"/\?(?:m|mgn)\&Auth\=[a-zA-Z0-9]{8}\&Session\=/"; sid:911001856;)
alert tcp any any -> any 80 (msg:"CosmicDuke Webdav Exfil"; content:"PUT /catalog/outgoing/wd"; pcre:"/PUT \/catalog\/outgoing\/wd[a-zA-Z0-9]{44}\.bin/"; sid:911001857;)
alert tcp any any -> any 21 (msg:"CosmicDuke FTP Exfil"; content:"STOR fp"; pcre:"/STOR fp[a-zAZ0-9]{44}\.bin/"; sid:911001858;)
